
``` r
library(knitr)
opts_knit$set(root.dir = "../")
opts_chunk$set(echo=TRUE, collapse=TRUE)
```

# reading messy spreadsheet data

I tried the jailbreakr package, but it isn’t on CRAN and the repo
doesn’t have any useful vignettes. There is a blog post though at
<https://www.brodrigues.co/blog/2017-02-17-how_to_use_jailbreakr/>

``` r
# install just once
# devtools::install_github(c("hadley/xml2",
#                            "rsheets/linen",
#                            "rsheets/cellranger",
#                            "rsheets/rexcel",
#                            "rsheets/jailbreakr"))
```

Following the instructions at the blog,

``` r
library("rexcel")
library("jailbreakr")

path_to_data <- "data/us_income.xlsx"
my_sheet     <- rexcel_read(path_to_data, sheet = "us_income")
tables       <- split_sheet(my_sheet)
```

Not sure what that all is. But keep going

``` r
library(purrr)
list_of_data <-  map(tables, (function(x) (x$values())))
map(list_of_data, head)
## [[1]]
##      [,1]                                                                     
## [1,] "CPH-L-131B. Size of Household--Households by Total Money Income in 1989"
##      [,2]       
## [1,] " by State"
## 
## [[2]]
##      [,1]                                                                                                             
## [1,] "---------------------------------------------------------------------------------------------------" [truncated]
## [2,] "                              Total"                                                                            
## [3,] "State"                                                                                                          
## [4,] "---------------------------------------------------------------------------------------------------" [truncated]
## [5,] "UNITED STATES"                                                                                                  
##      [,2]         [,3]         [,4]         [,5]         [,6]        
## [1,] NA           NA           NA           NA           NA          
## [2,] "1-Person"   "2-Person"   "3-Person"   "4-Person"   "5-Person"  
## [3,] "households" "households" "households" "households" "households"
## [4,] NA           NA           NA           NA           NA          
## [5,] NA           NA           NA           NA           NA          
##      [,7]         [,8]        
## [1,] NA           NA          
## [2,] "6+-Persons" NA          
## [3,] "households" "households"
## [4,] NA           NA          
## [5,] NA           NA          
## 
## [[3]]
##      [,1]                 [,2]     [,3]     [,4]     [,5]     [,6]    
## [1,] "  Total"            91993582 22421114 29379586 15962545 13956079
## [2,] "Less than $5,000"   5684517  3133102  1110021  654919   424657  
## [3,] "$5,000 to $9,999"   8529980  4794603  1920691  805991   530572  
## [4,] "$10,000 to $12,499" 4365873  1870742  1344979  498885   338178  
## [5,] "$12,500 to $14,999" 3767400  1358942  1324321  470640   320274  
## [6,] "$15,000 to $17,499" 4260641  1459614  1468477  576427   406782  
##      [,7]    [,8]   
## [1,] 6445357 3828901
## [2,] 209023  152795 
## [3,] 276289  201834 
## [4,] 180655  132434 
## [5,] 166569  126654 
## [6,] 205608  143733 
## 
## [[4]]
##      [,1]     
## [1,] "ALABAMA"
## 
## [[5]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            1506009 354918 478471 284277 237174 99577 51592
## [2,] "Less than $5,000"   159594  90974  29968  17169  11515  5702  4266 
## [3,] "$5,000 to $9,999"   178304  84753  52197  19636  11307  5952  4459 
## [4,] "$10,000 to $12,499" 87687   28920  31201  12628  8321   3967  2650 
## [5,] "$12,500 to $14,999" 73372   21121  27017  12044  7142   3515  2533 
## [6,] "$15,000 to $17,499" 80452   21027  28331  14234  9432   4442  2986 
## 
## [[6]]
##      [,1]    
## [1,] "ALASKA"
## 
## [[7]]
##      [,1]                 [,2]   [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
## [1,] "  Total"            189700 41510 54822 34314 33073 15991 9990
## [2,] "Less than $5,000"   6631   3458  1473  760   457   263   220 
## [3,] "$5,000 to $9,999"   9152   4905  2009  1008  669   308   253 
## [4,] "$10,000 to $12,499" 6156   2505  1339  1104  652   359   197 
## [5,] "$12,500 to $14,999" 5972   2215  1302  1009  783   410   253 
## [6,] "$15,000 to $17,499" 6229   2225  1543  974   837   390   260 
## 
## [[8]]
##      [,1]     
## [1,] "ARIZONA"
## 
## [[9]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            1371885 335745 475924 212912 184414 92198 70692
## [2,] "Less than $5,000"   89648   45592  18937  9732   7540   4117  3730 
## [3,] "$5,000 to $9,999"   123594  64810  29289  11043  7993   5098  5361 
## [4,] "$10,000 to $12,499" 72815   30647  22144  7907   5638   3220  3259 
## [5,] "$12,500 to $14,999" 63125   21889  22050  7236   5523   3362  3065 
## [6,] "$15,000 to $17,499" 72759   24604  25446  8719   6491   3905  3594 
## 
## [[10]]
##      [,1]      
## [1,] "ARKANSAS"
## 
## [[11]]
##      [,1]                 [,2]   [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            891665 212166 301328 159200 134238 55435 29298
## [2,] "Less than $5,000"   91721  54371  17003  8916   6082   3183  2166 
## [3,] "$5,000 to $9,999"   118433 56129  37016  11785  7119   3555  2829 
## [4,] "$10,000 to $12,499" 60519  19834  22216  8219   5567   2867  1816 
## [5,] "$12,500 to $14,999" 50307  13333  19797  7672   5275   2409  1821 
## [6,] "$15,000 to $17,499" 54098  13448  20429  9033   6492   2784  1912 
## 
## [[12]]
##      [,1]        
## [1,] "CALIFORNIA"
## 
## [[13]]
##      [,1]                 [,2]     [,3]    [,4]    [,5]    [,6]    [,7]  
## [1,] "  Total"            10399700 2416267 3219779 1724477 1527453 793257
## [2,] "Less than $5,000"   403714   203849  82110   44397   34250   18921 
## [3,] "$5,000 to $9,999"   793789   456380  147322  85125   55978   26382 
## [4,] "$10,000 to $12,499" 408399   168179  106083  46125   37705   27467 
## [5,] "$12,500 to $14,999" 363356   121614  118658  43672   33776   20892 
## [6,] "$15,000 to $17,499" 409665   138100  124037  51702   42312   26831 
##      [,8]  
## [1,] 718467
## [2,] 20187 
## [3,] 22602 
## [4,] 22840 
## [5,] 24744 
## [6,] 26683 
## 
## [[14]]
##      [,1]      
## [1,] "COLORADO"
## 
## [[15]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            1285119 340413 424450 213245 190935 79498 36578
## [2,] "Less than $5,000"   67384   37901  14738  8224   3979   1662  880  
## [3,] "$5,000 to $9,999"   108370  64786  22653  9046   6803   3278  1804 
## [4,] "$10,000 to $12,499" 62779   28811  18576  7044   4781   2195  1372 
## [5,] "$12,500 to $14,999" 54159   22210  17483  6395   4491   2390  1190 
## [6,] "$15,000 to $17,499" 62295   24507  20168  7565   5886   2731  1438 
## 
## [[16]]
##      [,1]         
## [1,] "CONNECTICUT"
## 
## [[17]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            1230243 294463 397466 223021 195192 83277 36824
## [2,] "Less than $5,000"   40314   24646  6484   3997   2841   1282  1064 
## [3,] "$5,000 to $9,999"   79365   53480  12600  6334   4162   1928  861  
## [4,] "$10,000 to $12,499" 36306   20404  9645   2817   1873   843   724  
## [5,] "$12,500 to $14,999" 31329   15644  9795   2794   1784   812   500  
## [6,] "$15,000 to $17,499" 35821   16337  12326  3393   2304   953   508  
## 
## [[18]]
##      [,1]      
## [1,] "DELAWARE"
## 
## [[19]]
##      [,1]                 [,2]   [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
## [1,] "  Total"            247163 57070 80704 46323 38632 16490 7944
## [2,] "Less than $5,000"   10392  6033  2124  1176  685   243   131 
## [3,] "$5,000 to $9,999"   16313  10353 3107  1382  743   356   372 
## [4,] "$10,000 to $12,499" 9405   4509  2650  1115  699   288   144 
## [5,] "$12,500 to $14,999" 8675   3364  3163  1029  624   359   136 
## [6,] "$15,000 to $17,499" 9763   3486  3406  1414  824   394   239 
## 
## [[20]]
##      [,1]                  
## [1,] "DISTRICT OF COLUMBIA"
## 
## [[21]]
##      [,1]                 [,2]   [,3]   [,4]  [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            249034 102947 66926 33466 22570 11854 11271
## [2,] "Less than $5,000"   21687  13181  3737  2312  1323  590   544  
## [3,] "$5,000 to $9,999"   19437  11773  3534  1783  1125  580   642  
## [4,] "$10,000 to $12,499" 10286  5430   2481  1210  621   302   242  
## [5,] "$12,500 to $14,999" 7552   3802   1794  903   495   305   253  
## [6,] "$15,000 to $17,499" 10554  5486   2450  1214  545   454   405  
## 
## [[22]]
##      [,1]     
## [1,] "FLORIDA"
## 
## [[23]]
##      [,1]                 [,2]    [,3]    [,4]    [,5]   [,6]   [,7]  
## [1,] "  Total"            5138360 1300064 1935187 818060 637903 283803
## [2,] "Less than $5,000"   315168  184388  61465   31143  20830  10783 
## [3,] "$5,000 to $9,999"   460392  265824  115498  35984  22517  11601 
## [4,] "$10,000 to $12,499" 274023  120630  93245   27806  17558  8763  
## [5,] "$12,500 to $14,999" 235705  87944   90892   26577  16295  8101  
## [6,] "$15,000 to $17,499" 277116  97523   106530  33271  21940  10823 
##      [,8]  
## [1,] 163343
## [2,] 6559  
## [3,] 8968  
## [4,] 6021  
## [5,] 5896  
## [6,] 7029  
## 
## [[24]]
##      [,1]     
## [1,] "GEORGIA"
## 
## [[25]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            2366575 533234 740025 457421 385593 163351 86951
## [2,] "Less than $5,000"   187826  102494 34638  22997  15339  7919   4439 
## [3,] "$5,000 to $9,999"   210252  100489 58515  23401  14718  7183   5946 
## [4,] "$10,000 to $12,499" 110044  39727  35917  15936  10063  4800   3601 
## [5,] "$12,500 to $14,999" 94098   28509  32761  15126  9882   4744   3076 
## [6,] "$15,000 to $17,499" 111240  34481  35775  18276  12783  6111   3814 
## 
## [[26]]
##      [,1]    
## [1,] "HAWAII"
## 
## [[27]]
##      [,1]                 [,2]   [,3]  [,4]   [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            356748 67857 102726 65722 59136 31772 29535
## [2,] "Less than $5,000"   13393  8155  2362   1288  752   497   339  
## [3,] "$5,000 to $9,999"   18011  9357  4334   1838  1484  681   317  
## [4,] "$10,000 to $12,499" 10981  4294  3044   1483  1078  666   416  
## [5,] "$12,500 to $14,999" 10676  3921  3351   1343  1102  499   460  
## [6,] "$15,000 to $17,499" 13140  4276  3953   2045  1533  774   559  
## 
## [[28]]
##      [,1]   
## [1,] "IDAHO"
## 
## [[29]]
##      [,1]                 [,2]   [,3]  [,4]   [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            361432 80364 122797 55994 53089 27238 21950
## [2,] "Less than $5,000"   19805  11579 4114   2130  1182  478   322  
## [3,] "$5,000 to $9,999"   38078  21559 9479   3043  1954  1231  812  
## [4,] "$10,000 to $12,499" 20979  8178  7377   2226  1723  849   626  
## [5,] "$12,500 to $14,999" 19542  5888  7517   2398  1844  1050  845  
## [6,] "$15,000 to $17,499" 21930  6273  8348   2913  2279  1174  943  
## 
## [[30]]
##      [,1]      
## [1,] "ILLINOIS"
## 
## [[31]]
##      [,1]                 [,2]    [,3]    [,4]    [,5]   [,6]   [,7]  
## [1,] "  Total"            4197720 1071131 1273998 705044 640343 314087
## [2,] "Less than $5,000"   254426  136753  44718   33070  22612  10097 
## [3,] "$5,000 to $9,999"   341673  204817  64160   27801  20952  13324 
## [4,] "$10,000 to $12,499" 176049  88196   48034   16990  11407  6269  
## [5,] "$12,500 to $14,999" 153992  64635   50607   16514  11387  6006  
## [6,] "$15,000 to $17,499" 176628  69850   58811   20604  14478  7243  
##      [,8]  
## [1,] 193117
## [2,] 7176  
## [3,] 10619 
## [4,] 5153  
## [5,] 4843  
## [6,] 5642  
## 
## [[32]]
##      [,1]     
## [1,] "INDIANA"
## 
## [[33]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            2064246 493305 666873 365749 327677 143430 67212
## [2,] "Less than $5,000"   112983  63399  22005  13756  8512   3534   1777 
## [3,] "$5,000 to $9,999"   186940  115838 38516  15171  9594   4711   3110 
## [4,] "$10,000 to $12,499" 101425  48443  30669  11054  6394   3154   1711 
## [5,] "$12,500 to $14,999" 90499   35035  33295  10552  6715   3209   1693 
## [6,] "$15,000 to $17,499" 103797  36962  37547  13565  9233   4135   2355 
## 
## [[34]]
##      [,1]  
## [1,] "IOWA"
## 
## [[35]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            1065243 274365 367093 164062 156645 73629 29449
## [2,] "Less than $5,000"   59821   36338  12590  5844   2989   1316  744  
## [3,] "$5,000 to $9,999"   113277  69643  25133  8742   5840   2713  1206 
## [4,] "$10,000 to $12,499" 58528   27951  19364  5236   3321   1642  1014 
## [5,] "$12,500 to $14,999" 53033   21741  19687  5245   3596   2025  739  
## [6,] "$15,000 to $17,499" 57963   20678  22012  6727   5073   2424  1049 
## 
## [[36]]
##      [,1]    
## [1,] "KANSAS"
## 
## [[37]]
##      [,1]                 [,2]   [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            946253 243325 316475 150654 141999 65373 28427
## [2,] "Less than $5,000"   56138  34731  10904  5685   2878   1260  680  
## [3,] "$5,000 to $9,999"   93556  56244  21187  6777   5268   2856  1224 
## [4,] "$10,000 to $12,499" 49938  23276  16055  4868   3278   1638  823  
## [5,] "$12,500 to $14,999" 43643  17051  15858  4711   3507   1695  821  
## [6,] "$15,000 to $17,499" 49162  18047  17255  6225   4273   2222  1140 
## 
## [[38]]
##      [,1]      
## [1,] "KENTUCKY"
## 
## [[39]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            1379610 319383 440086 271928 222515 88364 37334
## [2,] "Less than $5,000"   145176  73847  31079  19404  12348  5684  2814 
## [3,] "$5,000 to $9,999"   176377  80188  51427  21420  13203  6505  3634 
## [4,] "$10,000 to $12,499" 85439   28682  30302  13063  7750   3700  1942 
## [5,] "$12,500 to $14,999" 70493   19175  26916  11802  7856   3243  1501 
## [6,] "$15,000 to $17,499" 75759   19609  27217  13439  9492   4148  1854 
## 
## [[40]]
##      [,1]       
## [1,] "LOUISIANA"
## 
## [[41]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            1498371 351609 431324 276308 244417 121003 73710
## [2,] "Less than $5,000"   188156  89670  36975  24859  17756  10311  8585 
## [3,] "$5,000 to $9,999"   187026  79586  51353  23428  15136  9428   8095 
## [4,] "$10,000 to $12,499" 92975   29488  28964  14567  9932   5571   4453 
## [5,] "$12,500 to $14,999" 75174   19826  26143  12243  8172   4788   4002 
## [6,] "$15,000 to $17,499" 78579   20027  25151  13789  10160  5421   4031 
## 
## [[42]]
##      [,1]   
## [1,] "MAINE"
## 
## [[43]]
##      [,1]                 [,2]   [,3]   [,4]   [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            465729 107856 158537 83547 75634 28951 11204
## [2,] "Less than $5,000"   23344  15556  4428   1850  965   387   158  
## [3,] "$5,000 to $9,999"   48062  28579  11683  4367  2351  803   279  
## [4,] "$10,000 to $12,499" 23404  9526   8898   2298  1672  706   304  
## [5,] "$12,500 to $14,999" 21011  7569   8092   2531  1797  626   396  
## [6,] "$15,000 to $17,499" 24359  8146   9397   3167  2147  1079  423  
## 
## [[44]]
##      [,1]      
## [1,] "MARYLAND"
## 
## [[45]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            1749342 391814 548326 339910 282572 120762 65958
## [2,] "Less than $5,000"   76524   43400  14456  9887   4952   2244   1585 
## [3,] "$5,000 to $9,999"   96326   56544  19943  8646   6467   2943   1783 
## [4,] "$10,000 to $12,499" 51557   24801  15131  5588   3386   1458   1193 
## [5,] "$12,500 to $14,999" 46479   19536  15438  5553   3438   1511   1003 
## [6,] "$15,000 to $17,499" 57816   23010  18576  7878   4861   1943   1548 
## 
## [[46]]
##      [,1]           
## [1,] "MASSACHUSETTS"
## 
## [[47]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            2244406 576230 697272 392399 345434 156851 76220
## [2,] "Less than $5,000"   91295   56245  16982  8507   5580   2384   1597 
## [3,] "$5,000 to $9,999"   209406  139566 36208  17062  9742   4294   2534 
## [4,] "$10,000 to $12,499" 79429   40714  24576  6626   4209   1841   1463 
## [5,] "$12,500 to $14,999" 66929   30137  23575  6253   3753   1981   1230 
## [6,] "$15,000 to $17,499" 76818   32420  27014  8317   5254   2459   1354 
## 
## [[48]]
##      [,1]      
## [1,] "MICHIGAN"
## 
## [[49]]
##      [,1]                 [,2]    [,3]   [,4]    [,5]   [,6]   [,7]  
## [1,] "  Total"            3424122 805670 1082989 599049 546615 256880
## [2,] "Less than $5,000"   203692  110230 44711   23783  14044  6617  
## [3,] "$5,000 to $9,999"   329871  178626 70998   37360  24286  11573 
## [4,] "$10,000 to $12,499" 157429  69904  47931   16779  12174  5944  
## [5,] "$12,500 to $14,999" 136230  51529  49267   15284  10623  5479  
## [6,] "$15,000 to $17,499" 148772  51487  55486   18760  12959  6257  
##      [,8]  
## [1,] 132919
## [2,] 4307  
## [3,] 7028  
## [4,] 4697  
## [5,] 4048  
## [6,] 3823  
## 
## [[50]]
##      [,1]       
## [1,] "MINNESOTA"
## 
## [[51]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            1648825 411914 540255 265031 257118 121015 53492
## [2,] "Less than $5,000"   72190   50127  11956  4264   3006   1586   1251 
## [3,] "$5,000 to $9,999"   155847  92150  35992  13570  8143   3880   2112 
## [4,] "$10,000 to $12,499" 75108   36908  23339  6466   4403   2345   1647 
## [5,] "$12,500 to $14,999" 66147   27594  24172  6295   4443   2029   1614 
## [6,] "$15,000 to $17,499" 74543   28470  27610  8055   5635   2935   1838 
## 
## [[52]]
##      [,1]         
## [1,] "MISSISSIPPI"
## 
## [[53]]
##      [,1]                 [,2]   [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            910574 210277 268274 168253 146466 69775 47529
## [2,] "Less than $5,000"   118663 63836  21219  13541  9375   5354  5338 
## [3,] "$5,000 to $9,999"   129769 53003  38047  15518  10789  6421  5991 
## [4,] "$10,000 to $12,499" 59375  16431  20329  9404   6680   3242  3289 
## [5,] "$12,500 to $14,999" 49524  11691  16850  8392   6277   3243  3071 
## [6,] "$15,000 to $17,499" 51499  12041  16226  9246   7295   3612  3079 
## 
## [[54]]
##      [,1]      
## [1,] "MISSOURI"
## 
## [[55]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            1961364 507394 644778 332065 289110 127529 60488
## [2,] "Less than $5,000"   140008  83393  25519  15274  9038   4371   2413 
## [3,] "$5,000 to $9,999"   208126  119300 50977  17233  11067  5793   3756 
## [4,] "$10,000 to $12,499" 108083  46878  36057  11825  7872   3265   2186 
## [5,] "$12,500 to $14,999" 94186   33968  35706  11750  7079   3777   1906 
## [6,] "$15,000 to $17,499" 101419  33716  37727  13941  9251   4127   2657 
## 
## [[56]]
##      [,1]     
## [1,] "MONTANA"
## 
## [[57]]
##      [,1]                 [,2]   [,3]  [,4]   [,5]  [,6]  [,7]  [,8]
## [1,] "  Total"            306919 80214 103789 46904 44865 21164 9983
## [2,] "Less than $5,000"   22480  12921 4861   2583  1230  561   324 
## [3,] "$5,000 to $9,999"   38514  21630 9214   3143  2312  1330  885 
## [4,] "$10,000 to $12,499" 20207  8560  6727   2168  1598  702   452 
## [5,] "$12,500 to $14,999" 17347  6006  6463   2136  1542  746   454 
## [6,] "$15,000 to $17,499" 18405  6003  6831   2371  1792  909   499 
## 
## [[58]]
##      [,1]      
## [1,] "NEBRASKA"
## 
## [[59]]
##      [,1]                 [,2]   [,3]   [,4]   [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            602858 158927 199560 91633 89291 43550 19897
## [2,] "Less than $5,000"   33706  21798  6177   2890  1691  713   437  
## [3,] "$5,000 to $9,999"   61896  39074  13561  4164  2881  1488  728  
## [4,] "$10,000 to $12,499" 34988  17064  10890  3180  1988  1212  654  
## [5,] "$12,500 to $14,999" 29673  11913  10777  3062  2162  1113  646  
## [6,] "$15,000 to $17,499" 34504  12894  12238  4013  3119  1515  725  
## 
## [[60]]
##      [,1]    
## [1,] "NEVADA"
## 
## [[61]]
##      [,1]                 [,2]   [,3]   [,4]   [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            467513 118805 163765 78009 60596 28246 18092
## [2,] "Less than $5,000"   21665  12039  4865   2378  1539  474   370  
## [3,] "$5,000 to $9,999"   33022  20995  6898   2343  1442  717   627  
## [4,] "$10,000 to $12,499" 22480  11130  6944   2135  1294  647   330  
## [5,] "$12,500 to $14,999" 18488  7874   6366   1975  1199  630   444  
## [6,] "$15,000 to $17,499" 22851  9565   7235   2988  1741  671   651  
## 
## [[62]]
##      [,1]           
## [1,] "NEW HAMPSHIRE"
## 
## [[63]]
##      [,1]                 [,2]   [,3]  [,4]   [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            411387 90101 137568 75150 69977 28053 10538
## [2,] "Less than $5,000"   13747  9206  2502   1089  661   206   83   
## [3,] "$5,000 to $9,999"   27508  18593 5399   1735  1174  434   173  
## [4,] "$10,000 to $12,499" 14651  7545  4766   1223  734   261   122  
## [5,] "$12,500 to $14,999" 12923  5459  4958   1262  718   438   88   
## [6,] "$15,000 to $17,499" 15126  6179  5463   1703  1102  463   216  
## 
## [[64]]
##      [,1]        
## [1,] "NEW JERSEY"
## 
## [[65]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]  
## [1,] "  Total"            2794316 640436 849064 508751 460358 216113
## [2,] "Less than $5,000"   105777  59366  19352  12604  7907   3956  
## [3,] "$5,000 to $9,999"   181344  120515 28888  13728  10013  4971  
## [4,] "$10,000 to $12,499" 88549   46641  25146  7284   5201   2530  
## [5,] "$12,500 to $14,999" 76962   34673  26339  6752   4933   2394  
## [6,] "$15,000 to $17,499" 90067   35840  31052  11128  6499   3353  
##      [,8]  
## [1,] 119594
## [2,] 2592  
## [3,] 3229  
## [4,] 1747  
## [5,] 1871  
## [6,] 2195  
## 
## [[66]]
##      [,1]        
## [1,] "NEW MEXICO"
## 
## [[67]]
##      [,1]                 [,2]   [,3]   [,4]   [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            543825 124220 167808 93316 85983 43510 28988
## [2,] "Less than $5,000"   47783  23341  9332   6178  4539  2341  2052 
## [3,] "$5,000 to $9,999"   59626  25557  15274  7032  5505  3480  2778 
## [4,] "$10,000 to $12,499" 33439  11264  9394   4890  3810  2235  1846 
## [5,] "$12,500 to $14,999" 28560  7908   9186   4612  3466  1891  1497 
## [6,] "$15,000 to $17,499" 30842  8257   9319   4868  4182  2362  1854 
## 
## [[68]]
##      [,1]      
## [1,] "NEW YORK"
## 
## [[69]]
##      [,1]                 [,2]    [,3]    [,4]    [,5]    [,6]   [,7]  
## [1,] "  Total"            6634434 1788656 1938056 1126431 983769 485043
## [2,] "Less than $5,000"   402744  207435  77904   51902   34905  17627 
## [3,] "$5,000 to $9,999"   629440  389614  110837  56922   37696  19482 
## [4,] "$10,000 to $12,499" 271735  128760  75578   28490   20221  10458 
## [5,] "$12,500 to $14,999" 222366  90576   72436   25676   17391  9009  
## [6,] "$15,000 to $17,499" 256098  98634   82867   31675   22619  11631 
##      [,8]  
## [1,] 312479
## [2,] 12971 
## [3,] 14889 
## [4,] 8228  
## [5,] 7278  
## [6,] 8672  
## 
## [[70]]
##      [,1]            
## [1,] "NORTH CAROLINA"
## 
## [[71]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            2517098 593293 845469 487931 381212 144152 65041
## [2,] "Less than $5,000"   185418  113494 34802  18856  10676  4936   2654 
## [3,] "$5,000 to $9,999"   243607  126657 71290  23519  12644  5973   3524 
## [4,] "$10,000 to $12,499" 135514  53414  47326  18249  9377   4598   2550 
## [5,] "$12,500 to $14,999" 114982  37351  42592  17731  10329  4554   2425 
## [6,] "$15,000 to $17,499" 134392  44478  46902  21095  13508  5543   2866 
## 
## [[72]]
##      [,1]          
## [1,] "NORTH DAKOTA"
## 
## [[73]]
##      [,1]                 [,2]   [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
## [1,] "  Total"            241802 63790 78632 36784 36643 18419 7534
## [2,] "Less than $5,000"   17526  10754 3593  1599  824   495   261 
## [3,] "$5,000 to $9,999"   29125  16107 7317  2592  1595  890   624 
## [4,] "$10,000 to $12,499" 14928  6623  4887  1557  1054  478   329 
## [5,] "$12,500 to $14,999" 13621  5007  4984  1605  1151  555   319 
## [6,] "$15,000 to $17,499" 14491  5162  5051  1794  1464  736   284 
## 
## [[74]]
##      [,1]  
## [1,] "OHIO"
## 
## [[75]]
##      [,1]                 [,2]    [,3]    [,4]    [,5]   [,6]   [,7]  
## [1,] "  Total"            4089312 1014571 1300447 719950 634879 286782
## [2,] "Less than $5,000"   270387  141725  54665   39205  22971  7862  
## [3,] "$5,000 to $9,999"   386874  229262  77241   32788  24277  14455 
## [4,] "$10,000 to $12,499" 194921  91561   58170   20985  13252  6845  
## [5,] "$12,500 to $14,999" 174110  68711   62264   20353  12871  6356  
## [6,] "$15,000 to $17,499" 194443  71017   70394   25031  16298  7527  
##      [,8]  
## [1,] 132683
## [2,] 3959  
## [3,] 8851  
## [4,] 4108  
## [5,] 3555  
## [6,] 4176  
## 
## [[76]]
##      [,1]      
## [1,] "OKLAHOMA"
## 
## [[77]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            1207235 306695 403021 203509 181402 77261 35347
## [2,] "Less than $5,000"   97831   53533  21161  11441  6960   3140  1596 
## [3,] "$5,000 to $9,999"   152521  81581  39327  14252  9336   5084  2941 
## [4,] "$10,000 to $12,499" 73350   27258  25175  9090   6633   3428  1766 
## [5,] "$12,500 to $14,999" 62637   19343  23052  9012   6582   2904  1744 
## [6,] "$15,000 to $17,499" 68806   20586  24322  10446  7749   3747  1956 
## 
## [[78]]
##      [,1]    
## [1,] "OREGON"
## 
## [[79]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            1105362 277631 393755 173917 156211 68133 35715
## [2,] "Less than $5,000"   60824   37762  13111  5352   2702   1181  716  
## [3,] "$5,000 to $9,999"   108006  63584  24676  9470   5947   2799  1530 
## [4,] "$10,000 to $12,499" 60510   27431  20066  6095   3789   1853  1276 
## [5,] "$12,500 to $14,999" 51915   19537  19537  6048   3716   1989  1088 
## [6,] "$15,000 to $17,499" 58740   20413  22718  7054   4657   2351  1547 
## 
## [[80]]
##      [,1]          
## [1,] "PENNSYLVANIA"
## 
## [[81]]
##      [,1]                 [,2]    [,3]    [,4]    [,5]   [,6]   [,7]  
## [1,] "  Total"            4492958 1142393 1438051 788273 679256 301988
## [2,] "Less than $5,000"   244825  138479  49697   29229  15758  6917  
## [3,] "$5,000 to $9,999"   452700  293567  83022   33279  24121  11648 
## [4,] "$10,000 to $12,499" 221502  109097  68155   20039  13085  6745  
## [5,] "$12,500 to $14,999" 193801  78442   73164   19594  12470  6321  
## [6,] "$15,000 to $17,499" 215433  77227   83556   25698  17038  7834  
##      [,8]  
## [1,] 142997
## [2,] 4745  
## [3,] 7063  
## [4,] 4381  
## [5,] 3810  
## [6,] 4080  
## 
## [[82]]
##      [,1]          
## [1,] "RHODE ISLAND"
## 
## [[83]]
##      [,1]                 [,2]   [,3]  [,4]   [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            377080 97919 117305 67107 58583 24689 11477
## [2,] "Less than $5,000"   15653  10441 2531   1237  807   399   238  
## [3,] "$5,000 to $9,999"   39408  26440 7071   3058  1739  810   290  
## [4,] "$10,000 to $12,499" 16310  8474  4745   1495  956   416   224  
## [5,] "$12,500 to $14,999" 14211  5955  5519   1286  762   403   286  
## [6,] "$15,000 to $17,499" 15717  6486  5430   2002  1059  448   292  
## 
## [[84]]
##      [,1]            
## [1,] "SOUTH CAROLINA"
## 
## [[85]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            1258783 278866 397406 241745 203634 87567 49565
## [2,] "Less than $5,000"   103342  58974  18417  11670  7672   3894  2715 
## [3,] "$5,000 to $9,999"   129447  64202  35349  13472  8679   4315  3430 
## [4,] "$10,000 to $12,499" 65925   22570  22719  9622   5940   2848  2226 
## [5,] "$12,500 to $14,999" 57054   16656  20812  8825   5781   2930  2050 
## [6,] "$15,000 to $17,499" 66733   18839  22185  11605  7909   3765  2430 
## 
## [[86]]
##      [,1]          
## [1,] "SOUTH DAKOTA"
## 
## [[87]]
##      [,1]                 [,2]   [,3]  [,4]  [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            260059 68038 85631 38270 37620 19998 10502
## [2,] "Less than $5,000"   19789  11747 3421  1717  1370  758   776  
## [3,] "$5,000 to $9,999"   31561  18171 7816  2174  1580  818   1002 
## [4,] "$10,000 to $12,499" 16881  7615  5496  1493  1054  670   553  
## [5,] "$12,500 to $14,999" 15127  5466  5513  1810  1169  697   472  
## [6,] "$15,000 to $17,499" 16501  5654  5826  1960  1574  929   558  
## 
## [[88]]
##      [,1]       
## [1,] "TENNESSEE"
## 
## [[89]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            1853515 439196 609161 359590 285731 109494 50343
## [2,] "Less than $5,000"   163648  94931  31096  18467  10993  5159   3002 
## [3,] "$5,000 to $9,999"   207221  101550 61692  21565  12852  5580   3982 
## [4,] "$10,000 to $12,499" 104740  36820  37566  15388  9035   3541   2390 
## [5,] "$12,500 to $14,999" 89526   26654  33841  13964  8677   4026   2364 
## [6,] "$15,000 to $17,499" 101753  29377  36707  17346  11175  4764   2384 
## 
## [[90]]
##      [,1]   
## [1,] "TEXAS"
## 
## [[91]]
##      [,1]                 [,2]    [,3]    [,4]    [,5]    [,6]   [,7]  
## [1,] "  Total"            6079341 1440639 1821962 1052101 960197 478766
## [2,] "Less than $5,000"   496730  247454  95815   59969   44797  25935 
## [3,] "$5,000 to $9,999"   581538  266805  146822  64410   46416  29502 
## [4,] "$10,000 to $12,499" 325235  115405  93789   44216   33326  20915 
## [5,] "$12,500 to $14,999" 271934  82048   83858   40115   30281  18943 
## [6,] "$15,000 to $17,499" 308097  94876   90784   46810   36315  21640 
##      [,8]  
## [1,] 325676
## [2,] 22760 
## [3,] 27583 
## [4,] 17584 
## [5,] 16689 
## [6,] 17672 
## 
## [[92]]
##      [,1]  
## [1,] "UTAH"
## 
## [[93]]
##      [,1]                 [,2]   [,3]   [,4]   [,5]  [,6]  [,7]  [,8] 
## [1,] "  Total"            537196 100855 152571 83368 80595 54064 65743
## [2,] "Less than $5,000"   23914  12508  5098   3029  1583  942   754  
## [3,] "$5,000 to $9,999"   43891  23097  9846   4351  3300  1784  1513 
## [4,] "$10,000 to $12,499" 26303  10357  8152   3125  2308  1212  1149 
## [5,] "$12,500 to $14,999" 23423  7084   7866   3244  2665  1392  1172 
## [6,] "$15,000 to $17,499" 26600  7293   9279   4067  2654  1660  1647 
## 
## [[94]]
##      [,1]     
## [1,] "VERMONT"
## 
## [[95]]
##      [,1]                 [,2]   [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
## [1,] "  Total"            210633 49165 71173 37060 34330 13769 5136
## [2,] "Less than $5,000"   6984   4700  1227  611   302   113   31  
## [3,] "$5,000 to $9,999"   21152  13398 4756  1602  882   423   91  
## [4,] "$10,000 to $12,499" 10332  4792  3264  1039  721   349   167 
## [5,] "$12,500 to $14,999" 8739   3436  3110  1039  711   346   97  
## [6,] "$15,000 to $17,499" 10274  3753  3836  1164  910   413   198 
## 
## [[96]]
##      [,1]      
## [1,] "VIRGINIA"
## 
## [[97]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            2294722 520868 751230 444986 360594 145663 71381
## [2,] "Less than $5,000"   124579  70319  25498  14916  8495   3407   1944 
## [3,] "$5,000 to $9,999"   163929  86321  43910  17173  9652   4088   2785 
## [4,] "$10,000 to $12,499" 92112   38193  29471  12628  7042   3104   1674 
## [5,] "$12,500 to $14,999" 81599   28778  28211  12191  7616   3017   1786 
## [6,] "$15,000 to $17,499" 95097   32083  32091  14895  9658   4133   2237 
## 
## [[98]]
##      [,1]        
## [1,] "WASHINGTON"
## 
## [[99]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            1875508 473924 644119 305502 272175 118107 61681
## [2,] "Less than $5,000"   85161   53264  17470  7132   4001   1823   1471 
## [3,] "$5,000 to $9,999"   157317  92230  33461  16544  8923   4203   1956 
## [4,] "$10,000 to $12,499" 84161   41093  23741  8633   6015   2962   1717 
## [5,] "$12,500 to $14,999" 74442   31143  24607  8604   5668   2535   1885 
## [6,] "$15,000 to $17,499" 86048   33765  29258  10563  7177   3369   1916 
## 
## [[100]]
##      [,1]           
## [1,] "WEST VIRGINIA"
## 
## [[101]]
##      [,1]                 [,2]   [,3]   [,4]   [,5]   [,6]   [,7]  [,8] 
## [1,] "  Total"            688727 168115 221830 130370 109071 42814 16527
## [2,] "Less than $5,000"   73017  37233  15225  9976   6520   2940  1123 
## [3,] "$5,000 to $9,999"   95610  48611  24088  10697  7481   3280  1453 
## [4,] "$10,000 to $12,499" 48204  17698  16444  6470   4641   2005  946  
## [5,] "$12,500 to $14,999" 39974  11920  15335  5729   4386   1827  777  
## [6,] "$15,000 to $17,499" 40808  10149  15509  7045   5045   2129  931  
## 
## [[102]]
##      [,1]       
## [1,] "WISCONSIN"
## 
## [[103]]
##      [,1]                 [,2]    [,3]   [,4]   [,5]   [,6]   [,7]   [,8] 
## [1,] "  Total"            1824252 441553 596473 302347 285695 133910 64274
## [2,] "Less than $5,000"   67487   40122  13227  5951   4145   2261   1781 
## [3,] "$5,000 to $9,999"   187926  118663 35742  15934  9598   4870   3119 
## [4,] "$10,000 to $12,499" 90391   43896  27863  7940   5688   2930   2074 
## [5,] "$12,500 to $14,999" 80437   33082  29284  7621   5625   2784   2041 
## [6,] "$15,000 to $17,499" 87997   32176  33610  9487   6783   3561   2380 
## 
## [[104]]
##      [,1]     
## [1,] "WYOMING"
## 
## [[105]]
##      [,1]                 [,2]   [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
## [1,] "  Total"            169309 40953 54855 27110 27465 12712 6214
## [2,] "Less than $5,000"   9807   5410  2279  973   779   198   168 
## [3,] "$5,000 to $9,999"   17051  9697  4017  1541  1117  488   191 
## [4,] "$10,000 to $12,499" 9387   4215  2938  1067  659   350   158 
## [5,] "$12,500 to $14,999" 8341   2979  3061  1071  744   309   177 
## [6,] "$15,000 to $17,499" 8642   2672  3243  1153  986   384   204 
## 
## [[106]]
##      [,1]      [,2]                                   
## [1,] "SOURCE:" "1990 Census of Population and Housing"
## 
## [[107]]
##      [,1]                                    
## [1,] "Prepared by:"                          
## [2,] "Income Statistics Branch/HHES Division"
## [3,] "U.S. Census Bureau"                    
## [4,] "U.S. Department of Commerce"           
## [5,] "Washington, D.C. 20233-8500"           
## [6,] "(301) 763-3242"                        
## 
## [[108]]
##      [,1]                                                                   
## [1,] "  "                                                                   
## [2,] "    Source: U.S. Census Bureau, 1990 Census of Population and Housing"
## [3,] "  "                                                                   
## 
## [[109]]
##      [,1]                                                                                                             
## [1,] "  "                                                                                                             
## [2,] "For more information, contact the Housing and Household Economic Statistics Division's Statistical " [truncated]
## [3,] "  "
```

The variable `list_of_data` contains the discrete chunks of the messy
spreadsheet.

``` r
j <- 1
dataset_j <- list_of_data[[j]]
dataset_j
##      [,1]                                                                     
## [1,] "CPH-L-131B. Size of Household--Households by Total Money Income in 1989"
##      [,2]       
## [1,] " by State"


j <- 2
dataset_j <- list_of_data[[j]]
dataset_j
##      [,1]                                                                                                             
## [1,] "---------------------------------------------------------------------------------------------------" [truncated]
## [2,] "                              Total"                                                                            
## [3,] "State"                                                                                                          
## [4,] "---------------------------------------------------------------------------------------------------" [truncated]
## [5,] "UNITED STATES"                                                                                                  
##      [,2]         [,3]         [,4]         [,5]         [,6]        
## [1,] NA           NA           NA           NA           NA          
## [2,] "1-Person"   "2-Person"   "3-Person"   "4-Person"   "5-Person"  
## [3,] "households" "households" "households" "households" "households"
## [4,] NA           NA           NA           NA           NA          
## [5,] NA           NA           NA           NA           NA          
##      [,7]         [,8]        
## [1,] NA           NA          
## [2,] "6+-Persons" NA          
## [3,] "households" "households"
## [4,] NA           NA          
## [5,] NA           NA


j <- 3
dataset_j <- list_of_data[[j]]
dataset_j
##       [,1]                   [,2]     [,3]     [,4]     [,5]     [,6]    
##  [1,] "  Total"              91993582 22421114 29379586 15962545 13956079
##  [2,] "Less than $5,000"     5684517  3133102  1110021  654919   424657  
##  [3,] "$5,000 to $9,999"     8529980  4794603  1920691  805991   530572  
##  [4,] "$10,000 to $12,499"   4365873  1870742  1344979  498885   338178  
##  [5,] "$12,500 to $14,999"   3767400  1358942  1324321  470640   320274  
##  [6,] "$15,000 to $17,499"   4260641  1459614  1468477  576427   406782  
##  [7,] "$17,500 to $19,999"   3844339  1155865  1393256  551371   402729  
##  [8,] "$20,000 to $22,499"   4395954  1285519  1541983  652452   506541  
##  [9,] "$22,500 to $24,999"   3622808  884984   1340173  583045   450607  
## [10,] "$25,000 to $27,499"   4105099  1002987  1425362  686877   561145  
## [11,] "$27,500 to $29,999"   3328905  666462   1204774  596197   491490  
## [12,] "$30,000 to $32,499"   4108519  885773   1361887  733251   658529  
## [13,] "$32,500 to $34,999"   3032602  466211   1077753  594171   519004  
## [14,] "$35,000 to $37,499"   3487169  580910   1164752  680884   625873  
## [15,] "$37,500 to $39,999"   2727253  350720   942348   559498   516730  
## [16,] "$40,000 to $42,499"   3254665  457288   1068914  659436   643792  
## [17,] "$42,500 to $44,999"   2360699  233185   801961   516555   482155  
## [18,] "$45,000 to $47,499"   2565438  263880   850189   554800   539779  
## [19,] "$47,500 to $49,999"   2033231  169987   679107   455456   437911  
## [20,] "$50,000 to $54,999"   4078012  348281   1336247  905525   900024  
## [21,] "$55,000 to $59,999"   3135172  196082   1031356  729851   709686  
## [22,] "$60,000 to $74,499"   6564699  371242   2115214  1546459  1517643 
## [23,] "$75,000 to $99,999"   4704808  227985   1499612  1101306  1095433 
## [24,] "$100,000 to $124,999" 1831758  105203   595312   402169   412327  
## [25,] "$125,000 to $149,999" 762010   43063    261200   162726   162316  
## [26,] "$150,000 or more"     1442031  108484   519697   283654   301902  
## [27,] "Median (dollars)"     30056    15091    31130    37119    40873   
##       [,7]    [,8]   
##  [1,] 6445357 3828901
##  [2,] 209023  152795 
##  [3,] 276289  201834 
##  [4,] 180655  132434 
##  [5,] 166569  126654 
##  [6,] 205608  143733 
##  [7,] 201758  139360 
##  [8,] 252123  157336 
##  [9,] 223020  140979 
## [10,] 268740  159988 
## [11,] 232804  137178 
## [12,] 301888  167191 
## [13,] 239822  135641 
## [14,] 283606  151144 
## [15,] 230646  127311 
## [16,] 281285  143950 
## [17,] 212859  113984 
## [18,] 233985  122805 
## [19,] 188287  102483 
## [20,] 385808  202127 
## [21,] 303531  164666 
## [22,] 654966  359175 
## [23,] 488428  292044 
## [24,] 194316  122431 
## [25,] 80455   52250  
## [26,] 148886  79408  
## [27,] 39459   36974

j <- 4
dataset_j <- list_of_data[[j]]
dataset_j
##      [,1]     
## [1,] "ALABAMA"


j <- 5
dataset_j <- list_of_data[[j]]
dataset_j
##       [,1]                   [,2]    [,3]   [,4]   [,5]   [,6]   [,7] 
##  [1,] "  Total"              1506009 354918 478471 284277 237174 99577
##  [2,] "Less than $5,000"     159594  90974  29968  17169  11515  5702 
##  [3,] "$5,000 to $9,999"     178304  84753  52197  19636  11307  5952 
##  [4,] "$10,000 to $12,499"   87687   28920  31201  12628  8321   3967 
##  [5,] "$12,500 to $14,999"   73372   21121  27017  12044  7142   3515 
##  [6,] "$15,000 to $17,499"   80452   21027  28331  14234  9432   4442 
##  [7,] "$17,500 to $19,999"   69295   15826  25202  12398  9068   4383 
##  [8,] "$20,000 to $22,499"   77582   16760  27048  14434  11558  4973 
##  [9,] "$22,500 to $24,999"   60915   10371  22186  12356  9386   4166 
## [10,] "$25,000 to $27,499"   68890   12198  23477  13894  11906  4883 
## [11,] "$27,500 to $29,999"   55259   7546   20042  11552  9738   4465 
## [12,] "$30,000 to $32,499"   66054   10139  21451  13753  13277  5067 
## [13,] "$32,500 to $34,999"   46312   4903   15804  10457  9911   3585 
## [14,] "$35,000 to $37,499"   52327   5291   16857  12454  11456  4456 
## [15,] "$37,500 to $39,999"   40353   3690   13110  9578   8976   3377 
## [16,] "$40,000 to $42,499"   46500   4241   14451  11438  10287  4372 
## [17,] "$42,500 to $44,999"   32960   1932   10670  8477   7669   2891 
## [18,] "$45,000 to $47,499"   34693   2420   10442  8896   8300   3175 
## [19,] "$47,500 to $49,999"   27921   1602   9045   6896   6688   2587 
## [20,] "$50,000 to $54,999"   53863   3037   16479  13166  13707  5413 
## [21,] "$55,000 to $59,999"   40469   1700   12494  10636  10269  3877 
## [22,] "$60,000 to $74,499"   74358   2892   23328  19228  19311  6776 
## [23,] "$75,000 to $99,999"   44820   1840   14885  11304  10793  4126 
## [24,] "$100,000 to $124,999" 15298   662    5737   3567   3362   1405 
## [25,] "$125,000 to $149,999" 6217    305    2378   1424   1113   737  
## [26,] "$150,000 or more"     12514   768    4671   2658   2682   1285 
## [27,] "Median (dollars)"     23597   10150  24559  30326  33998  31648
##       [,8] 
##  [1,] 51592
##  [2,] 4266 
##  [3,] 4459 
##  [4,] 2650 
##  [5,] 2533 
##  [6,] 2986 
##  [7,] 2418 
##  [8,] 2809 
##  [9,] 2450 
## [10,] 2532 
## [11,] 1916 
## [12,] 2367 
## [13,] 1652 
## [14,] 1813 
## [15,] 1622 
## [16,] 1711 
## [17,] 1321 
## [18,] 1460 
## [19,] 1103 
## [20,] 2061 
## [21,] 1493 
## [22,] 2823 
## [23,] 1872 
## [24,] 565  
## [25,] 260  
## [26,] 450  
## [27,] 26210

j <- 6
dataset_j <- list_of_data[[j]]
dataset_j
##      [,1]    
## [1,] "ALASKA"


j <- 7
dataset_j <- list_of_data[[j]]
dataset_j
##       [,1]                   [,2]   [,3]  [,4]  [,5]  [,6]  [,7]  [,8] 
##  [1,] "  Total"              189700 41510 54822 34314 33073 15991 9990 
##  [2,] "Less than $5,000"     6631   3458  1473  760   457   263   220  
##  [3,] "$5,000 to $9,999"     9152   4905  2009  1008  669   308   253  
##  [4,] "$10,000 to $12,499"   6156   2505  1339  1104  652   359   197  
##  [5,] "$12,500 to $14,999"   5972   2215  1302  1009  783   410   253  
##  [6,] "$15,000 to $17,499"   6229   2225  1543  974   837   390   260  
##  [7,] "$17,500 to $19,999"   5900   1788  1636  900   879   378   319  
##  [8,] "$20,000 to $22,499"   6870   2362  1876  981   817   546   288  
##  [9,] "$22,500 to $24,999"   6140   1846  1702  1029  767   448   348  
## [10,] "$25,000 to $27,499"   6952   2050  2007  1063  983   502   347  
## [11,] "$27,500 to $29,999"   6080   1475  1772  1011  990   467   365  
## [12,] "$30,000 to $32,499"   6924   2125  1964  863   1093  566   313  
## [13,] "$32,500 to $34,999"   5917   1344  1685  1145  858   580   305  
## [14,] "$35,000 to $37,499"   6414   1524  1823  1141  1011  553   362  
## [15,] "$37,500 to $39,999"   5836   1162  1800  1010  999   524   341  
## [16,] "$40,000 to $42,499"   6529   1605  1948  1001  1054  596   325  
## [17,] "$42,500 to $44,999"   5268   916   1824  935   883   446   264  
## [18,] "$45,000 to $47,499"   5890   1127  1852  1039  1043  477   352  
## [19,] "$47,500 to $49,999"   5185   766   1586  916   1032  569   316  
## [20,] "$50,000 to $54,999"   10428  1691  2924  1927  2110  1085  691  
## [21,] "$55,000 to $59,999"   8235   847   2452  1711  1946  859   420  
## [22,] "$60,000 to $74,499"   21756  1811  6996  4735  4870  2072  1272 
## [23,] "$75,000 to $99,999"   20626  1090  6742  4634  4901  2074  1185 
## [24,] "$100,000 to $124,999" 7870   321   2461  2010  1774  807   497  
## [25,] "$125,000 to $149,999" 2903   119   954   689   684   286   171  
## [26,] "$150,000 or more"     3837   233   1152  719   981   426   326  
## [27,] "Median (dollars)"     41408  24257 44600 48002 51603 48302 46669
```

## using the tidyverse

``` r
library(tidyverse)
## -- Attaching packages --------------------------------------------------------------------------------- tidyverse 1.2.1 --
## v ggplot2 3.0.0.9000     v readr   1.1.1     
## v tibble  1.4.2          v dplyr   0.7.6     
## v tidyr   0.8.1          v stringr 1.3.1     
## v ggplot2 3.0.0.9000     v forcats 0.3.0
## -- Conflicts ------------------------------------------------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
```

``` r
rawlines <- read_lines("data/us_income.csv")
head(rawlines)
## [1] "CPH-L-131B. Size of Household--Households by Total Money Income in 1989, by State,,,,,,"                            
## [2] ",,,,,,,"                                                                                                            
## [3] ",,,,,,,"                                                                                                            
## [4] ",,,,,,,"                                                                                                            
## [5] "------------------------------------------------------------------------------------------------------------,,,,,,,"
## [6] "                              Total,1-Person,2-Person,3-Person,4-Person,5-Person,6+-Persons,"
```

Find the row with Alabama

``` r
str(rawlines)
##  chr [1:1640] "CPH-L-131B. Size of Household--Households by Total Money Income in 1989, by State,,,,,," ...

grep("Alabama", rawlines, ignore.case = TRUE)
## [1] 40
grep("Alaska", rawlines, ignore.case = TRUE)
## [1] 71
```

Find all 50 state names, using the built-in state data.

``` r
state.name
##  [1] "Alabama"        "Alaska"         "Arizona"        "Arkansas"      
##  [5] "California"     "Colorado"       "Connecticut"    "Delaware"      
##  [9] "Florida"        "Georgia"        "Hawaii"         "Idaho"         
## [13] "Illinois"       "Indiana"        "Iowa"           "Kansas"        
## [17] "Kentucky"       "Louisiana"      "Maine"          "Maryland"      
## [21] "Massachusetts"  "Michigan"       "Minnesota"      "Mississippi"   
## [25] "Missouri"       "Montana"        "Nebraska"       "Nevada"        
## [29] "New Hampshire"  "New Jersey"     "New Mexico"     "New York"      
## [33] "North Carolina" "North Dakota"   "Ohio"           "Oklahoma"      
## [37] "Oregon"         "Pennsylvania"   "Rhode Island"   "South Carolina"
## [41] "South Dakota"   "Tennessee"      "Texas"          "Utah"          
## [45] "Vermont"        "Virginia"       "Washington"     "West Virginia" 
## [49] "Wisconsin"      "Wyoming"
```

``` r
state_name <- state.name
indices <- sapply(state_name, function(x) grep(x, rawlines, ignore.case = TRUE, fixed = FALSE))
str(indices)
## List of 50
##  $ Alabama       : int 40
##  $ Alaska        : int 71
##  $ Arizona       : int 102
##  $ Arkansas      : int 133
##  $ California    : int 164
##  $ Colorado      : int 195
##  $ Connecticut   : int 226
##  $ Delaware      : int 257
##  $ Florida       : int 319
##  $ Georgia       : int 350
##  $ Hawaii        : int 381
##  $ Idaho         : int 412
##  $ Illinois      : int 443
##  $ Indiana       : int 474
##  $ Iowa          : int 505
##  $ Kansas        : int [1:2] 133 536
##  $ Kentucky      : int 567
##  $ Louisiana     : int 598
##  $ Maine         : int 629
##  $ Maryland      : int 660
##  $ Massachusetts : int 691
##  $ Michigan      : int 722
##  $ Minnesota     : int 753
##  $ Mississippi   : int 784
##  $ Missouri      : int 815
##  $ Montana       : int 846
##  $ Nebraska      : int 877
##  $ Nevada        : int 908
##  $ New Hampshire : int 939
##  $ New Jersey    : int 970
##  $ New Mexico    : int 1001
##  $ New York      : int 1032
##  $ North Carolina: int 1063
##  $ North Dakota  : int 1094
##  $ Ohio          : int 1125
##  $ Oklahoma      : int 1156
##  $ Oregon        : int 1187
##  $ Pennsylvania  : int 1218
##  $ Rhode Island  : int 1249
##  $ South Carolina: int 1280
##  $ South Dakota  : int 1311
##  $ Tennessee     : int 1342
##  $ Texas         : int 1373
##  $ Utah          : int 1404
##  $ Vermont       : int 1435
##  $ Virginia      : int [1:2] 1466 1528
##  $ Washington    : int [1:2] 1497 1627
##  $ West Virginia : int 1528
##  $ Wisconsin     : int 1559
##  $ Wyoming       : int 1590
```

Some have two results because “kansas” as a string is also in Arkansas.
Virginia is also in West Virginia. washingtom is in the footnotes

``` r
indices$Kansas     <- indices$Kansas[2]
indices$Virginia   <- indices$Virginia[1]
indices$Washington <- indices$Washington[1]
str(indices)
## List of 50
##  $ Alabama       : int 40
##  $ Alaska        : int 71
##  $ Arizona       : int 102
##  $ Arkansas      : int 133
##  $ California    : int 164
##  $ Colorado      : int 195
##  $ Connecticut   : int 226
##  $ Delaware      : int 257
##  $ Florida       : int 319
##  $ Georgia       : int 350
##  $ Hawaii        : int 381
##  $ Idaho         : int 412
##  $ Illinois      : int 443
##  $ Indiana       : int 474
##  $ Iowa          : int 505
##  $ Kansas        : int 536
##  $ Kentucky      : int 567
##  $ Louisiana     : int 598
##  $ Maine         : int 629
##  $ Maryland      : int 660
##  $ Massachusetts : int 691
##  $ Michigan      : int 722
##  $ Minnesota     : int 753
##  $ Mississippi   : int 784
##  $ Missouri      : int 815
##  $ Montana       : int 846
##  $ Nebraska      : int 877
##  $ Nevada        : int 908
##  $ New Hampshire : int 939
##  $ New Jersey    : int 970
##  $ New Mexico    : int 1001
##  $ New York      : int 1032
##  $ North Carolina: int 1063
##  $ North Dakota  : int 1094
##  $ Ohio          : int 1125
##  $ Oklahoma      : int 1156
##  $ Oregon        : int 1187
##  $ Pennsylvania  : int 1218
##  $ Rhode Island  : int 1249
##  $ South Carolina: int 1280
##  $ South Dakota  : int 1311
##  $ Tennessee     : int 1342
##  $ Texas         : int 1373
##  $ Utah          : int 1404
##  $ Vermont       : int 1435
##  $ Virginia      : int 1466
##  $ Washington    : int 1497
##  $ West Virginia : int 1528
##  $ Wisconsin     : int 1559
##  $ Wyoming       : int 1590
```

``` r
first_row <- unname(unlist(indices))
str(first_row)
##  int [1:50] 40 71 102 133 164 195 226 257 319 350 ...

delta <- diff(first_row)
delta <- diff(first_row)[1] - 3
delta
## [1] 28
```

Cnstruct data frame with indices

``` r
df_indices <- data_frame(state = state_name) %>% 
    mutate(first_row = first_row) %>% 
    mutate(last_row = first_row + delta)



glimpse(df_indices)
## Observations: 50
## Variables: 3
## $ state     <chr> "Alabama", "Alaska", "Arizona", "Arkansas", "Califor...
## $ first_row <int> 40, 71, 102, 133, 164, 195, 226, 257, 319, 350, 381,...
## $ last_row  <dbl> 68, 99, 130, 161, 192, 223, 254, 285, 347, 378, 409,...
```

Extract one state and write to file

``` r
j = 6
this_state <- df_indices$state[j]
state_data <- rawlines[df_indices$first_row[j]:df_indices$last_row[j]]
state_data
##  [1] "COLORADO,,,,,,,"                                                                                 
##  [2] ",,,,,,,"                                                                                         
##  [3] "  Total,\"1,285,119\",\"340,413\",\"424,450\",\"213,245\",\"190,935\",\"79,498\",\"36,578\""     
##  [4] "\"Less than $5,000\",\"67,384\",\"37,901\",\"14,738\",\"8,224\",\"3,979\",\"1,662\",880"         
##  [5] "\"$5,000 to $9,999\",\"108,370\",\"64,786\",\"22,653\",\"9,046\",\"6,803\",\"3,278\",\"1,804\""  
##  [6] "\"$10,000 to $12,499\",\"62,779\",\"28,811\",\"18,576\",\"7,044\",\"4,781\",\"2,195\",\"1,372\"" 
##  [7] "\"$12,500 to $14,999\",\"54,159\",\"22,210\",\"17,483\",\"6,395\",\"4,491\",\"2,390\",\"1,190\"" 
##  [8] "\"$15,000 to $17,499\",\"62,295\",\"24,507\",\"20,168\",\"7,565\",\"5,886\",\"2,731\",\"1,438\"" 
##  [9] "\"$17,500 to $19,999\",\"56,158\",\"19,552\",\"19,285\",\"7,484\",\"5,726\",\"2,898\",\"1,213\"" 
## [10] "\"$20,000 to $22,499\",\"64,977\",\"22,096\",\"21,827\",\"8,905\",\"7,057\",\"3,412\",\"1,680\"" 
## [11] "\"$22,500 to $24,999\",\"54,267\",\"15,130\",\"19,879\",\"8,047\",\"6,619\",\"3,060\",\"1,532\"" 
## [12] "\"$25,000 to $27,499\",\"59,657\",\"16,652\",\"21,095\",\"9,363\",\"7,457\",\"3,542\",\"1,548\"" 
## [13] "\"$27,500 to $29,999\",\"49,150\",\"11,483\",\"18,008\",\"8,573\",\"6,702\",\"3,048\",\"1,336\"" 
## [14] "\"$30,000 to $32,499\",\"60,126\",\"14,962\",\"20,106\",\"10,155\",\"9,415\",\"3,795\",\"1,693\""
## [15] "\"$32,500 to $34,999\",\"44,212\",\"8,016\",\"16,357\",\"7,935\",\"7,249\",\"3,336\",\"1,319\""  
## [16] "\"$35,000 to $37,499\",\"49,067\",\"9,238\",\"17,084\",\"9,280\",\"8,544\",\"3,423\",\"1,498\""  
## [17] "\"$37,500 to $39,999\",\"40,033\",\"6,185\",\"14,398\",\"7,709\",\"7,213\",\"3,196\",\"1,332\""  
## [18] "\"$40,000 to $42,499\",\"47,203\",\"7,392\",\"16,143\",\"8,812\",\"9,877\",\"3,465\",\"1,514\""  
## [19] "\"$42,500 to $44,999\",\"34,321\",\"3,950\",\"11,974\",\"7,021\",\"7,374\",\"2,657\",\"1,345\""  
## [20] "\"$45,000 to $47,499\",\"37,278\",\"4,038\",\"13,298\",\"7,805\",\"7,969\",\"2,860\",\"1,308\""  
## [21] "\"$47,500 to $49,999\",\"29,540\",\"2,704\",\"10,894\",\"5,979\",\"6,682\",\"2,260\",\"1,021\""  
## [22] "\"$50,000 to $54,999\",\"58,337\",\"5,648\",\"20,851\",\"12,362\",\"12,583\",\"4,874\",\"2,019\""
## [23] "\"$55,000 to $59,999\",\"44,412\",\"3,248\",\"15,549\",\"9,724\",\"10,387\",\"3,881\",\"1,623\"" 
## [24] "\"$60,000 to $74,499\",\"91,036\",\"5,651\",\"32,898\",\"20,779\",\"20,631\",\"7,631\",\"3,446\""
## [25] "\"$75,000 to $99,999\",\"61,432\",\"3,150\",\"22,283\",\"14,614\",\"13,422\",\"5,596\",\"2,367\""
## [26] "\"$100,000 to $124,999\",\"23,048\",\"1,217\",\"8,761\",\"5,192\",\"4,925\",\"1,768\",\"1,185\"" 
## [27] "\"$125,000 to $149,999\",\"9,261\",615,\"3,551\",\"2,126\",\"1,766\",925,278"                    
## [28] "\"$150,000 or more\",\"16,617\",\"1,271\",\"6,591\",\"3,106\",\"3,397\",\"1,615\",637"           
## [29] "Median (dollars),\"30,140\",\"16,683\",\"32,302\",\"37,125\",\"40,897\",\"38,266\",\"37,143\""

this_path <- paste0("data/", this_state, ".csv")
write_lines(state_data, this_path)
```

Read the file , keep only the columns we need

``` r
df <- read_csv(this_path, skip = 2, col_names = FALSE) %>% 
    mutate(state = this_state) 
## Parsed with column specification:
## cols(
##   X1 = col_character(),
##   X2 = col_number(),
##   X3 = col_number(),
##   X4 = col_number(),
##   X5 = col_number(),
##   X6 = col_number(),
##   X7 = col_number(),
##   X8 = col_number()
## )

kable(df)
```

| X1                   |      X2 |     X3 |     X4 |     X5 |     X6 |    X7 |    X8 | state    |
| :------------------- | ------: | -----: | -----: | -----: | -----: | ----: | ----: | :------- |
| Total                | 1285119 | 340413 | 424450 | 213245 | 190935 | 79498 | 36578 | Colorado |
| Less than $5,000     |   67384 |  37901 |  14738 |   8224 |   3979 |  1662 |   880 | Colorado |
| $5,000 to $9,999     |  108370 |  64786 |  22653 |   9046 |   6803 |  3278 |  1804 | Colorado |
| $10,000 to $12,499   |   62779 |  28811 |  18576 |   7044 |   4781 |  2195 |  1372 | Colorado |
| $12,500 to $14,999   |   54159 |  22210 |  17483 |   6395 |   4491 |  2390 |  1190 | Colorado |
| $15,000 to $17,499   |   62295 |  24507 |  20168 |   7565 |   5886 |  2731 |  1438 | Colorado |
| $17,500 to $19,999   |   56158 |  19552 |  19285 |   7484 |   5726 |  2898 |  1213 | Colorado |
| $20,000 to $22,499   |   64977 |  22096 |  21827 |   8905 |   7057 |  3412 |  1680 | Colorado |
| $22,500 to $24,999   |   54267 |  15130 |  19879 |   8047 |   6619 |  3060 |  1532 | Colorado |
| $25,000 to $27,499   |   59657 |  16652 |  21095 |   9363 |   7457 |  3542 |  1548 | Colorado |
| $27,500 to $29,999   |   49150 |  11483 |  18008 |   8573 |   6702 |  3048 |  1336 | Colorado |
| $30,000 to $32,499   |   60126 |  14962 |  20106 |  10155 |   9415 |  3795 |  1693 | Colorado |
| $32,500 to $34,999   |   44212 |   8016 |  16357 |   7935 |   7249 |  3336 |  1319 | Colorado |
| $35,000 to $37,499   |   49067 |   9238 |  17084 |   9280 |   8544 |  3423 |  1498 | Colorado |
| $37,500 to $39,999   |   40033 |   6185 |  14398 |   7709 |   7213 |  3196 |  1332 | Colorado |
| $40,000 to $42,499   |   47203 |   7392 |  16143 |   8812 |   9877 |  3465 |  1514 | Colorado |
| $42,500 to $44,999   |   34321 |   3950 |  11974 |   7021 |   7374 |  2657 |  1345 | Colorado |
| $45,000 to $47,499   |   37278 |   4038 |  13298 |   7805 |   7969 |  2860 |  1308 | Colorado |
| $47,500 to $49,999   |   29540 |   2704 |  10894 |   5979 |   6682 |  2260 |  1021 | Colorado |
| $50,000 to $54,999   |   58337 |   5648 |  20851 |  12362 |  12583 |  4874 |  2019 | Colorado |
| $55,000 to $59,999   |   44412 |   3248 |  15549 |   9724 |  10387 |  3881 |  1623 | Colorado |
| $60,000 to $74,499   |   91036 |   5651 |  32898 |  20779 |  20631 |  7631 |  3446 | Colorado |
| $75,000 to $99,999   |   61432 |   3150 |  22283 |  14614 |  13422 |  5596 |  2367 | Colorado |
| $100,000 to $124,999 |   23048 |   1217 |   8761 |   5192 |   4925 |  1768 |  1185 | Colorado |
| $125,000 to $149,999 |    9261 |    615 |   3551 |   2126 |   1766 |   925 |   278 | Colorado |
| $150,000 or more     |   16617 |   1271 |   6591 |   3106 |   3397 |  1615 |   637 | Colorado |
| Median (dollars)     |   30140 |  16683 |  32302 |  37125 |  40897 | 38266 | 37143 | Colorado |

Extract the first row (total numbetr of households) and last row (median
income). Each column represents a different household size: 1-person,
2-perosn, etc.

``` r
m = dim(df)[1]
N_households   <- df[1, 2:8]
median_dollars <- df[m, 2:8]


N_households
## # A tibble: 1 x 7
##        X2     X3     X4     X5     X6    X7    X8
##     <dbl>  <dbl>  <dbl>  <dbl>  <dbl> <dbl> <dbl>
## 1 1285119 340413 424450 213245 190935 79498 36578
median_dollars
## # A tibble: 1 x 7
##      X2    X3    X4    X5    X6    X7    X8
##   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
## 1 30140 16683 32302 37125 40897 38266 37143
```

Summarize the number of households total and the median income.

``` r
N_households <- unname(unlist(N_households[1, 1]))
N_households
## [1] 1285119
median_dollars <- unname(unlist(median_dollars[1, 1]))
median_dollars
## [1] 30140
```

Omit the first and last row, add the median column

``` r
df <- df[2:(m-1), ] %>% 
    mutate(median_income =  median_dollars) %>% 
    select(state, X2, median_income, X1) %>% 
    rename(bracket = X1, households = X2)

m = dim(df)[1]
knitr::kable(df)
```

| state    | households | median\_income | bracket              |
| :------- | ---------: | -------------: | :------------------- |
| Colorado |      67384 |          30140 | Less than $5,000     |
| Colorado |     108370 |          30140 | $5,000 to $9,999     |
| Colorado |      62779 |          30140 | $10,000 to $12,499   |
| Colorado |      54159 |          30140 | $12,500 to $14,999   |
| Colorado |      62295 |          30140 | $15,000 to $17,499   |
| Colorado |      56158 |          30140 | $17,500 to $19,999   |
| Colorado |      64977 |          30140 | $20,000 to $22,499   |
| Colorado |      54267 |          30140 | $22,500 to $24,999   |
| Colorado |      59657 |          30140 | $25,000 to $27,499   |
| Colorado |      49150 |          30140 | $27,500 to $29,999   |
| Colorado |      60126 |          30140 | $30,000 to $32,499   |
| Colorado |      44212 |          30140 | $32,500 to $34,999   |
| Colorado |      49067 |          30140 | $35,000 to $37,499   |
| Colorado |      40033 |          30140 | $37,500 to $39,999   |
| Colorado |      47203 |          30140 | $40,000 to $42,499   |
| Colorado |      34321 |          30140 | $42,500 to $44,999   |
| Colorado |      37278 |          30140 | $45,000 to $47,499   |
| Colorado |      29540 |          30140 | $47,500 to $49,999   |
| Colorado |      58337 |          30140 | $50,000 to $54,999   |
| Colorado |      44412 |          30140 | $55,000 to $59,999   |
| Colorado |      91036 |          30140 | $60,000 to $74,499   |
| Colorado |      61432 |          30140 | $75,000 to $99,999   |
| Colorado |      23048 |          30140 | $100,000 to $124,999 |
| Colorado |       9261 |          30140 | $125,000 to $149,999 |
| Colorado |      16617 |          30140 | $150,000 or more     |

Separate the brackets

``` r
df <- df %>%
    separate(bracket, into = c("lower", "upper"), sep = "to")
## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 2 rows [1,
## 25].

knitr::kable(df)
```

| state    | households | median\_income | lower            | upper    |
| :------- | ---------: | -------------: | :--------------- | :------- |
| Colorado |      67384 |          30140 | Less than $5,000 | NA       |
| Colorado |     108370 |          30140 | $5,000           | $9,999   |
| Colorado |      62779 |          30140 | $10,000          | $12,499  |
| Colorado |      54159 |          30140 | $12,500          | $14,999  |
| Colorado |      62295 |          30140 | $15,000          | $17,499  |
| Colorado |      56158 |          30140 | $17,500          | $19,999  |
| Colorado |      64977 |          30140 | $20,000          | $22,499  |
| Colorado |      54267 |          30140 | $22,500          | $24,999  |
| Colorado |      59657 |          30140 | $25,000          | $27,499  |
| Colorado |      49150 |          30140 | $27,500          | $29,999  |
| Colorado |      60126 |          30140 | $30,000          | $32,499  |
| Colorado |      44212 |          30140 | $32,500          | $34,999  |
| Colorado |      49067 |          30140 | $35,000          | $37,499  |
| Colorado |      40033 |          30140 | $37,500          | $39,999  |
| Colorado |      47203 |          30140 | $40,000          | $42,499  |
| Colorado |      34321 |          30140 | $42,500          | $44,999  |
| Colorado |      37278 |          30140 | $45,000          | $47,499  |
| Colorado |      29540 |          30140 | $47,500          | $49,999  |
| Colorado |      58337 |          30140 | $50,000          | $54,999  |
| Colorado |      44412 |          30140 | $55,000          | $59,999  |
| Colorado |      91036 |          30140 | $60,000          | $74,499  |
| Colorado |      61432 |          30140 | $75,000          | $99,999  |
| Colorado |      23048 |          30140 | $100,000         | $124,999 |
| Colorado |       9261 |          30140 | $125,000         | $149,999 |
| Colorado |      16617 |          30140 | $150,000 or more | NA       |

Move the first row “less than”

``` r
df <- df %>% 
    mutate(lower = str_replace(lower, "Less than", "")) %>% 
    mutate(lower = str_replace(lower, "or more", ""))

df$upper[1] <- df$lower[1]
df$lower[1] <- 0
df$upper[m] <- NA

knitr::kable(df)
```

| state    | households | median\_income | lower    | upper    |
| :------- | ---------: | -------------: | :------- | :------- |
| Colorado |      67384 |          30140 | 0        | $5,000   |
| Colorado |     108370 |          30140 | $5,000   | $9,999   |
| Colorado |      62779 |          30140 | $10,000  | $12,499  |
| Colorado |      54159 |          30140 | $12,500  | $14,999  |
| Colorado |      62295 |          30140 | $15,000  | $17,499  |
| Colorado |      56158 |          30140 | $17,500  | $19,999  |
| Colorado |      64977 |          30140 | $20,000  | $22,499  |
| Colorado |      54267 |          30140 | $22,500  | $24,999  |
| Colorado |      59657 |          30140 | $25,000  | $27,499  |
| Colorado |      49150 |          30140 | $27,500  | $29,999  |
| Colorado |      60126 |          30140 | $30,000  | $32,499  |
| Colorado |      44212 |          30140 | $32,500  | $34,999  |
| Colorado |      49067 |          30140 | $35,000  | $37,499  |
| Colorado |      40033 |          30140 | $37,500  | $39,999  |
| Colorado |      47203 |          30140 | $40,000  | $42,499  |
| Colorado |      34321 |          30140 | $42,500  | $44,999  |
| Colorado |      37278 |          30140 | $45,000  | $47,499  |
| Colorado |      29540 |          30140 | $47,500  | $49,999  |
| Colorado |      58337 |          30140 | $50,000  | $54,999  |
| Colorado |      44412 |          30140 | $55,000  | $59,999  |
| Colorado |      91036 |          30140 | $60,000  | $74,499  |
| Colorado |      61432 |          30140 | $75,000  | $99,999  |
| Colorado |      23048 |          30140 | $100,000 | $124,999 |
| Colorado |       9261 |          30140 | $125,000 | $149,999 |
| Colorado |      16617 |          30140 | $150,000 | NA       |

Now remove all the dollar signs

``` r
df <- df %>% 
    mutate(lower = str_replace(lower, "\\$", "")) %>% 
    mutate(lower = str_replace(lower, ",", "")) %>% 
    mutate(lower = as.integer(lower))

df <- df %>% 
    mutate(upper = str_replace(upper, "\\$", "")) %>% 
    mutate(upper = str_replace(upper, ",", "")) %>% 
    mutate(upper = as.integer(upper))

glimpse(df)
## Observations: 25
## Variables: 5
## $ state         <chr> "Colorado", "Colorado", "Colorado", "Colorado", ...
## $ households    <dbl> 67384, 108370, 62779, 54159, 62295, 56158, 64977...
## $ median_income <dbl> 30140, 30140, 30140, 30140, 30140, 30140, 30140,...
## $ lower         <int> 0, 5000, 10000, 12500, 15000, 17500, 20000, 2250...
## $ upper         <int> 5000, 9999, 12499, 14999, 17499, 19999, 22499, 2...

knitr::kable(df)
```

| state    | households | median\_income |  lower |  upper |
| :------- | ---------: | -------------: | -----: | -----: |
| Colorado |      67384 |          30140 |      0 |   5000 |
| Colorado |     108370 |          30140 |   5000 |   9999 |
| Colorado |      62779 |          30140 |  10000 |  12499 |
| Colorado |      54159 |          30140 |  12500 |  14999 |
| Colorado |      62295 |          30140 |  15000 |  17499 |
| Colorado |      56158 |          30140 |  17500 |  19999 |
| Colorado |      64977 |          30140 |  20000 |  22499 |
| Colorado |      54267 |          30140 |  22500 |  24999 |
| Colorado |      59657 |          30140 |  25000 |  27499 |
| Colorado |      49150 |          30140 |  27500 |  29999 |
| Colorado |      60126 |          30140 |  30000 |  32499 |
| Colorado |      44212 |          30140 |  32500 |  34999 |
| Colorado |      49067 |          30140 |  35000 |  37499 |
| Colorado |      40033 |          30140 |  37500 |  39999 |
| Colorado |      47203 |          30140 |  40000 |  42499 |
| Colorado |      34321 |          30140 |  42500 |  44999 |
| Colorado |      37278 |          30140 |  45000 |  47499 |
| Colorado |      29540 |          30140 |  47500 |  49999 |
| Colorado |      58337 |          30140 |  50000 |  54999 |
| Colorado |      44412 |          30140 |  55000 |  59999 |
| Colorado |      91036 |          30140 |  60000 |  74499 |
| Colorado |      61432 |          30140 |  75000 |  99999 |
| Colorado |      23048 |          30140 | 100000 | 124999 |
| Colorado |       9261 |          30140 | 125000 | 149999 |
| Colorado |      16617 |          30140 | 150000 |     NA |

The max bracket can’t be averged because there is no upper limnit, so
I’ll just assign lwower to upper for that row.

``` r
df$upper[m] <- df$lower[m]
```

use the mean of the bracket to estimate the income for that bracket’s
households.

``` r
df <- df %>%
    mutate(bracket_mean = round((lower + upper) / 2, 0))

knitr::kable(df)
```

| state    | households | median\_income |  lower |  upper | bracket\_mean |
| :------- | ---------: | -------------: | -----: | -----: | ------------: |
| Colorado |      67384 |          30140 |      0 |   5000 |          2500 |
| Colorado |     108370 |          30140 |   5000 |   9999 |          7500 |
| Colorado |      62779 |          30140 |  10000 |  12499 |         11250 |
| Colorado |      54159 |          30140 |  12500 |  14999 |         13750 |
| Colorado |      62295 |          30140 |  15000 |  17499 |         16250 |
| Colorado |      56158 |          30140 |  17500 |  19999 |         18750 |
| Colorado |      64977 |          30140 |  20000 |  22499 |         21250 |
| Colorado |      54267 |          30140 |  22500 |  24999 |         23750 |
| Colorado |      59657 |          30140 |  25000 |  27499 |         26250 |
| Colorado |      49150 |          30140 |  27500 |  29999 |         28750 |
| Colorado |      60126 |          30140 |  30000 |  32499 |         31250 |
| Colorado |      44212 |          30140 |  32500 |  34999 |         33750 |
| Colorado |      49067 |          30140 |  35000 |  37499 |         36250 |
| Colorado |      40033 |          30140 |  37500 |  39999 |         38750 |
| Colorado |      47203 |          30140 |  40000 |  42499 |         41250 |
| Colorado |      34321 |          30140 |  42500 |  44999 |         43750 |
| Colorado |      37278 |          30140 |  45000 |  47499 |         46250 |
| Colorado |      29540 |          30140 |  47500 |  49999 |         48750 |
| Colorado |      58337 |          30140 |  50000 |  54999 |         52500 |
| Colorado |      44412 |          30140 |  55000 |  59999 |         57500 |
| Colorado |      91036 |          30140 |  60000 |  74499 |         67250 |
| Colorado |      61432 |          30140 |  75000 |  99999 |         87500 |
| Colorado |      23048 |          30140 | 100000 | 124999 |        112500 |
| Colorado |       9261 |          30140 | 125000 | 149999 |        137500 |
| Colorado |      16617 |          30140 | 150000 | 150000 |        150000 |

Finally, tyhe product of mean income and the number of households gives
a total income for each bracket. Use these results to find the total
income.

``` r
df <- df %>% 
    mutate(bracket_income = households * bracket_mean)

knitr::kable(df)
```

| state    | households | median\_income |  lower |  upper | bracket\_mean | bracket\_income |
| :------- | ---------: | -------------: | -----: | -----: | ------------: | --------------: |
| Colorado |      67384 |          30140 |      0 |   5000 |          2500 |       168460000 |
| Colorado |     108370 |          30140 |   5000 |   9999 |          7500 |       812775000 |
| Colorado |      62779 |          30140 |  10000 |  12499 |         11250 |       706263750 |
| Colorado |      54159 |          30140 |  12500 |  14999 |         13750 |       744686250 |
| Colorado |      62295 |          30140 |  15000 |  17499 |         16250 |      1012293750 |
| Colorado |      56158 |          30140 |  17500 |  19999 |         18750 |      1052962500 |
| Colorado |      64977 |          30140 |  20000 |  22499 |         21250 |      1380761250 |
| Colorado |      54267 |          30140 |  22500 |  24999 |         23750 |      1288841250 |
| Colorado |      59657 |          30140 |  25000 |  27499 |         26250 |      1565996250 |
| Colorado |      49150 |          30140 |  27500 |  29999 |         28750 |      1413062500 |
| Colorado |      60126 |          30140 |  30000 |  32499 |         31250 |      1878937500 |
| Colorado |      44212 |          30140 |  32500 |  34999 |         33750 |      1492155000 |
| Colorado |      49067 |          30140 |  35000 |  37499 |         36250 |      1778678750 |
| Colorado |      40033 |          30140 |  37500 |  39999 |         38750 |      1551278750 |
| Colorado |      47203 |          30140 |  40000 |  42499 |         41250 |      1947123750 |
| Colorado |      34321 |          30140 |  42500 |  44999 |         43750 |      1501543750 |
| Colorado |      37278 |          30140 |  45000 |  47499 |         46250 |      1724107500 |
| Colorado |      29540 |          30140 |  47500 |  49999 |         48750 |      1440075000 |
| Colorado |      58337 |          30140 |  50000 |  54999 |         52500 |      3062692500 |
| Colorado |      44412 |          30140 |  55000 |  59999 |         57500 |      2553690000 |
| Colorado |      91036 |          30140 |  60000 |  74499 |         67250 |      6122171000 |
| Colorado |      61432 |          30140 |  75000 |  99999 |         87500 |      5375300000 |
| Colorado |      23048 |          30140 | 100000 | 124999 |        112500 |      2592900000 |
| Colorado |       9261 |          30140 | 125000 | 149999 |        137500 |      1273387500 |
| Colorado |      16617 |          30140 | 150000 | 150000 |        150000 |      2492550000 |

Filter for all households with income less than or equal to the median.
Use these results to find the total income of low-income households.

``` r
low_income <- df %>% 
    filter(lower <= median_income)


knitr::kable(low_income)
```

| state    | households | median\_income | lower | upper | bracket\_mean | bracket\_income |
| :------- | ---------: | -------------: | ----: | ----: | ------------: | --------------: |
| Colorado |      67384 |          30140 |     0 |  5000 |          2500 |       168460000 |
| Colorado |     108370 |          30140 |  5000 |  9999 |          7500 |       812775000 |
| Colorado |      62779 |          30140 | 10000 | 12499 |         11250 |       706263750 |
| Colorado |      54159 |          30140 | 12500 | 14999 |         13750 |       744686250 |
| Colorado |      62295 |          30140 | 15000 | 17499 |         16250 |      1012293750 |
| Colorado |      56158 |          30140 | 17500 | 19999 |         18750 |      1052962500 |
| Colorado |      64977 |          30140 | 20000 | 22499 |         21250 |      1380761250 |
| Colorado |      54267 |          30140 | 22500 | 24999 |         23750 |      1288841250 |
| Colorado |      59657 |          30140 | 25000 | 27499 |         26250 |      1565996250 |
| Colorado |      49150 |          30140 | 27500 | 29999 |         28750 |      1413062500 |
| Colorado |      60126 |          30140 | 30000 | 32499 |         31250 |      1878937500 |
